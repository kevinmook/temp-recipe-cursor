"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _sosia = require("sosia");

var _react2 = require("@testing-library/react");

var _testUtils = _interopRequireDefault(require("react-dom/test-utils"));

var _EzSelectTest = _interopRequireDefault(require("./EzSelect.test.md"));

require("../mocks");

var _EzField = _interopRequireDefault(require("../EzField"));

var _jestGlobals = require("../../../jest-globals");

var _index = require("../../index");

var _Open = _interopRequireDefault(require("../Open"));

var _Media = _interopRequireDefault(require("../Media"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var scope = {
  EzField: _EzField["default"],
  EzButton: _index.EzButton,
  EzLayout: _index.EzLayout,
  EzFormLayout: _index.EzFormLayout,
  Open: _Open["default"],
  Media: _Media["default"]
};
describe('EzField', function () {
  (0, _sosia.visualSnapshots)({
    markdown: _EzSelectTest["default"],
    scope: _objectSpread({}, scope, {
      fireEvent: _react2.fireEvent
    })
  });
  describe('select list', function () {
    var inputLabel = 'Select dropdown';
    var options = [{
      label: 'All Upcoming',
      value: 'upcoming'
    }, {
      label: 'Today',
      value: 'today'
    }, {
      label: 'Tomorrow',
      value: 'tomorrow'
    }, {
      label: 'All Time',
      value: 'all'
    }, {
      label: 'Yesterday',
      value: 'yesterday'
    }, {
      label: 'Last 7 Days',
      value: 'week'
    }, {
      label: 'This Month',
      value: 'month'
    }];
    it('should suppress default browser behavior to select input text when tab focused', function () {
      var _render = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming"
      })),
          container = _render.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel); // NOTE: We can't actually simulate the tab key causing the focus/select behavior
      // as firing events does not change focus
      // see: https://github.com/jsdom/jsdom/issues/2102#issuecomment-355340966

      input.select();
      (0, _react2.act)(function () {
        return _testUtils["default"].Simulate.select(input);
      });
      expect(input.selectionEnd - input.selectionStart).toEqual(0);
    });
    it('should move virtual focus with arrow keys', function () {
      var _render2 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming"
      })),
          container = _render2.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel);

      var keyDown = function keyDown(key) {
        return _react2.fireEvent.keyDown(input, {
          key: key
        });
      };

      keyDown('ArrowDown');
      var option1 = (0, _react2.getByText)(container, 'All Upcoming');
      var option2 = (0, _react2.getByText)(container, 'Today');
      var lastOption = (0, _react2.getByText)(container, 'This Month');
      expect(option1).toHaveAttribute('aria-selected', 'true');
      expect(option2).toHaveAttribute('aria-selected', 'false');
      keyDown('ArrowDown');
      expect(option1).toHaveAttribute('aria-selected', 'false');
      expect(option2).toHaveAttribute('aria-selected', 'true');
      keyDown('ArrowUp');
      expect(option1).toHaveAttribute('aria-selected', 'true');
      expect(option2).toHaveAttribute('aria-selected', 'false');
      keyDown('ArrowUp');
      expect(lastOption).toHaveAttribute('aria-selected', 'true');
      expect(option1).toHaveAttribute('aria-selected', 'false');
      keyDown('ArrowDown');
      expect(option1).toHaveAttribute('aria-selected', 'true');
      expect(lastOption).toHaveAttribute('aria-selected', 'false');
    });
    it('should move virtual focus by matching typed characters to an option', function () {
      var _render3 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "today"
      })),
          container = _render3.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel);

      var keyDown = function keyDown(key) {
        return _react2.fireEvent.keyDown(input, {
          key: key
        });
      }; // open the menu


      keyDown('ArrowDown');
      var optionAllUpcoming = (0, _react2.getByText)(container, 'All Upcoming');
      var optionAllTime = (0, _react2.getByText)(container, 'All Time');
      expect(optionAllUpcoming).toHaveAttribute('aria-selected', 'false');
      expect(optionAllTime).toHaveAttribute('aria-selected', 'false');
      keyDown('a');
      expect(optionAllUpcoming).toHaveAttribute('aria-selected', 'true');
      expect(optionAllTime).toHaveAttribute('aria-selected', 'false');
      keyDown('l');
      keyDown('l');
      keyDown(' ');
      keyDown('t');
      expect(optionAllUpcoming).toHaveAttribute('aria-selected', 'false');
      expect(optionAllTime).toHaveAttribute('aria-selected', 'true'); // ignore subsequent "misses"

      keyDown('z');
      expect(optionAllUpcoming).toHaveAttribute('aria-selected', 'false');
      expect(optionAllTime).toHaveAttribute('aria-selected', 'true'); // ignore non-alphanumeric characters

      keyDown('*');
      expect(optionAllUpcoming).toHaveAttribute('aria-selected', 'false');
      expect(optionAllTime).toHaveAttribute('aria-selected', 'true');
    });
    it('should close the dropdown when escape is pressed', function () {
      var _render4 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming"
      })),
          container = _render4.container,
          queryByText = _render4.queryByText;

      var input = (0, _react2.getByLabelText)(container, inputLabel);

      var keyDown = function keyDown(key) {
        return _react2.fireEvent.keyDown(input, {
          key: key
        });
      };

      _react2.fireEvent.mouseDown(input);

      expect(queryByText('Today')).not.toBeNull();
      keyDown('Escape');
      expect(queryByText('Today')).toBeNull();
    });
    it('should trigger onChange for the current item when enter is pressed', function () {
      var onChange = jest.fn();

      var _render5 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming",
        onChange: onChange
      })),
          container = _render5.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel);

      var keyDown = function keyDown(key) {
        return _react2.fireEvent.keyDown(input, {
          key: key
        });
      }; // open the menu


      keyDown('ArrowDown'); // select the second next option (value is "today")

      keyDown('ArrowDown');
      keyDown('Enter');
      expect(onChange).toHaveBeenCalled();
      var lastCall = onChange.mock.calls[onChange.mock.calls.length - 1];
      expect(lastCall[0].target.value).toEqual('today');
    });
    it('should trigger onChange for the current item when space is pressed', function () {
      var onChange = jest.fn();

      var _render6 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming",
        onChange: onChange
      })),
          container = _render6.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel);

      var keyDown = function keyDown(key) {
        return _react2.fireEvent.keyDown(input, {
          key: key
        });
      }; // open the menu


      keyDown('ArrowDown'); // select the second next option (value is "today")

      keyDown('ArrowDown');
      keyDown(' ');
      expect(onChange).toHaveBeenCalled();
      var lastCall = onChange.mock.calls[onChange.mock.calls.length - 1];
      expect(lastCall[0].target.value).toEqual('today');
    });
    it('should trigger onChange for the current item when clicked', function () {
      var onChange = jest.fn();

      var _render7 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming",
        onChange: onChange
      })),
          container = _render7.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel); // open the menu

      _react2.fireEvent.mouseDown(input);

      var option2 = (0, _react2.getByText)(container, 'Today');

      _react2.fireEvent.mouseOver(option2);

      _react2.fireEvent.click(option2);

      expect(onChange).toHaveBeenCalled();
      var lastCall = onChange.mock.calls[onChange.mock.calls.length - 1];
      expect(lastCall[0].target.value).toEqual('today');
    });
    it('prevents the default event propagation on mouseDown on an option', function () {
      var onChange = jest.fn();

      var _render8 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming",
        onChange: onChange
      })),
          container = _render8.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel); // open the menu

      _react2.fireEvent.mouseDown(input);

      var option2 = (0, _react2.getByText)(container, 'Today');

      _react2.fireEvent.mouseOver(option2);

      var mockEvent = new MouseEvent('mousedown', {
        bubbles: true
      });
      Object.assign(mockEvent, {
        preventDefault: jest.fn()
      });
      (0, _react2.fireEvent)(option2, mockEvent);
      expect(mockEvent.preventDefault).toHaveBeenCalled();
    });
    it('should not trigger onChange on the initial render', function () {
      var onChange = jest.fn();
      (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming",
        onChange: onChange
      }));
      expect(onChange).not.toHaveBeenCalled();
    });
    it('should trigger onChange after matching typed characters to an option, even with the list is closed', function () {
      var onChange = jest.fn();

      var _render9 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "today",
        onChange: onChange
      })),
          container = _render9.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel);

      var keyDown = function keyDown(key) {
        return _react2.fireEvent.keyDown(input, {
          key: key
        });
      };

      keyDown('y');
      expect(onChange).toHaveBeenCalled();
      var lastCall = onChange.mock.calls[onChange.mock.calls.length - 1];
      expect(lastCall[0].target.value).toEqual('yesterday');
    });
    it('should not trigger onChange when re-rendered with new props', function () {
      var onChange = jest.fn();

      var _render10 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming",
        onChange: onChange
      })),
          rerender = _render10.rerender; // change to a new value


      rerender(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "tomorrow",
        onChange: onChange
      })); // "reset" back to original value

      rerender(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: options,
        value: "upcoming",
        onChange: onChange
      }));
      expect(onChange).not.toHaveBeenCalled();
    });
    it('should support choices with numeric values', function () {
      var onChange = jest.fn();
      var optionsWithNumericValues = [{
        label: 'Short',
        value: 5
      }, {
        label: 'Medium',
        value: 10
      }, {
        label: 'Long',
        value: 15
      }];

      var _render11 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField["default"], {
        type: "select",
        label: inputLabel,
        options: optionsWithNumericValues,
        value: 5,
        onChange: onChange
      })),
          container = _render11.container;

      var input = (0, _react2.getByLabelText)(container, inputLabel);

      var keyDown = function keyDown(key) {
        return _react2.fireEvent.keyDown(input, {
          key: key
        });
      }; // open the menu


      keyDown('ArrowDown'); // select the second next option (value is "Medium")

      keyDown('ArrowDown');
      keyDown('Enter');
      expect(onChange).toHaveBeenCalled();
      var lastCall = onChange.mock.calls[onChange.mock.calls.length - 1];
      expect(lastCall[0].target.value).toEqual(10);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL0V6RmllbGQvX190ZXN0c19fL0V6RmllbGQuc2VsZWN0LnRlc3QudHN4Il0sIm5hbWVzIjpbInNjb3BlIiwiRXpGaWVsZCIsIkV6QnV0dG9uIiwiRXpMYXlvdXQiLCJFekZvcm1MYXlvdXQiLCJPcGVuIiwiTWVkaWEiLCJkZXNjcmliZSIsIm1hcmtkb3duIiwiZXpTZWxlY3RUZXN0cyIsImZpcmVFdmVudCIsImlucHV0TGFiZWwiLCJvcHRpb25zIiwibGFiZWwiLCJ2YWx1ZSIsIml0IiwiY29udGFpbmVyIiwiaW5wdXQiLCJzZWxlY3QiLCJSZWFjdFRlc3RVdGlscyIsIlNpbXVsYXRlIiwiZXhwZWN0Iiwic2VsZWN0aW9uRW5kIiwic2VsZWN0aW9uU3RhcnQiLCJ0b0VxdWFsIiwia2V5RG93biIsImtleSIsIm9wdGlvbjEiLCJvcHRpb24yIiwibGFzdE9wdGlvbiIsInRvSGF2ZUF0dHJpYnV0ZSIsIm9wdGlvbkFsbFVwY29taW5nIiwib3B0aW9uQWxsVGltZSIsInF1ZXJ5QnlUZXh0IiwibW91c2VEb3duIiwibm90IiwidG9CZU51bGwiLCJvbkNoYW5nZSIsImplc3QiLCJmbiIsInRvSGF2ZUJlZW5DYWxsZWQiLCJsYXN0Q2FsbCIsIm1vY2siLCJjYWxscyIsImxlbmd0aCIsInRhcmdldCIsIm1vdXNlT3ZlciIsImNsaWNrIiwibW9ja0V2ZW50IiwiTW91c2VFdmVudCIsImJ1YmJsZXMiLCJPYmplY3QiLCJhc3NpZ24iLCJwcmV2ZW50RGVmYXVsdCIsInJlcmVuZGVyIiwib3B0aW9uc1dpdGhOdW1lcmljVmFsdWVzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsS0FBSyxHQUFHO0FBQUNDLEVBQUFBLE9BQU8sRUFBUEEsbUJBQUQ7QUFBVUMsRUFBQUEsUUFBUSxFQUFSQSxl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QyxHQUFHO0FBQUEsZUFBSWhCLGtCQUFVZSxPQUFWLENBQWtCUixLQUFsQixFQUF5QjtBQUFDUyxVQUFBQSxHQUFHLEVBQUhBO0FBQUQsU0FBekIsQ0FBSjtBQUFBLE9BQW5CLENBckJxRCxDQXVCckQ7OztBQUNBRCxNQUFBQSxPQUFPLENBQUMsV0FBRCxDQUFQLENBeEJxRCxDQTBCckQ7O0FBQ0FBLE1BQUFBLE9BQU8sQ0FBQyxXQUFELENBQVA7QUFFQUEsTUFBQUEsT0FBTyxDQUFDLE9BQUQsQ0FBUDtBQUVBSixNQUFBQSxNQUFNLENBQUNnQixRQUFELENBQU4sQ0FBaUJHLGdCQUFqQjtBQUVBLFVBQU1DLFFBQVEsR0FBR0osUUFBUSxDQUFDSyxJQUFULENBQWNDLEtBQWQsQ0FBb0JOLFFBQVEsQ0FBQ0ssSUFBVCxDQUFjQyxLQUFkLENBQW9CQyxNQUFwQixHQUE2QixDQUFqRCxDQUFqQjtBQUVBdkIsTUFBQUEsTUFBTSxDQUFDb0IsUUFBUSxDQUFDLENBQUQsQ0FBUixDQUFZSSxNQUFaLENBQW1CL0IsS0FBcEIsQ0FBTixDQUFpQ1UsT0FBakMsQ0FBeUMsRUFBekM7QUFDRCxLQXBDQyxDQUFGO0FBcUNELEdBL1dPLENBQVI7QUFnWEQsQ0FuWE8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge3Zpc3VhbFNuYXBzaG90c30gZnJvbSAnc29zaWEnO1xuaW1wb3J0IHtnZXRCeUxhYmVsVGV4dCwgZ2V0QnlUZXh0LCBmaXJlRXZlbnQsIGFjdH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgUmVhY3RUZXN0VXRpbHMgZnJvbSAncmVhY3QtZG9tL3Rlc3QtdXRpbHMnO1xuaW1wb3J0IGV6U2VsZWN0VGVzdHMgZnJvbSAnLi9FelNlbGVjdC50ZXN0Lm1kJztcbmltcG9ydCAnLi4vbW9ja3MnO1xuaW1wb3J0IEV6RmllbGQgZnJvbSAnLi4vRXpGaWVsZCc7XG5pbXBvcnQge2Z1bGxSZW5kZXIgYXMgcmVuZGVyfSBmcm9tICcuLi8uLi8uLi9qZXN0LWdsb2JhbHMnO1xuaW1wb3J0IHtFekZvcm1MYXlvdXQsIEV6QnV0dG9uLCBFekxheW91dH0gZnJvbSAnLi4vLi4vaW5kZXgnO1xuaW1wb3J0IE9wZW4gZnJvbSAnLi4vT3Blbic7XG5pbXBvcnQgTWVkaWEgZnJvbSAnLi4vTWVkaWEnO1xuXG5jb25zdCBzY29wZSA9IHtFekZpZWxkLCBFekJ1dHRvbiwgRXpMYXlvdXQsIEV6Rm9ybUxheW91dCwgT3BlbiwgTWVkaWF9O1xuXG5kZXNjcmliZSgnRXpGaWVsZCcsICgpID0+IHtcbiAgdmlzdWFsU25hcHNob3RzKHttYXJrZG93bjogZXpTZWxlY3RUZXN0cywgc2NvcGU6IHsuLi5zY29wZSwgZmlyZUV2ZW50fX0pO1xuXG4gIGRlc2NyaWJlKCdzZWxlY3QgbGlzdCcsICgpID0+IHtcbiAgICBjb25zdCBpbnB1dExhYmVsID0gJ1NlbGVjdCBkcm9wZG93bic7XG4gICAgY29uc3Qgb3B0aW9ucyA9IFtcbiAgICAgIHtsYWJlbDogJ0FsbCBVcGNvbWluZycsIHZhbHVlOiAndXBjb21pbmcnfSxcbiAgICAgIHtsYWJlbDogJ1RvZGF5JywgdmFsdWU6ICd0b2RheSd9LFxuICAgICAge2xhYmVsOiAnVG9tb3Jyb3cnLCB2YWx1ZTogJ3RvbW9ycm93J30sXG4gICAgICB7bGFiZWw6ICdBbGwgVGltZScsIHZhbHVlOiAnYWxsJ30sXG4gICAgICB7bGFiZWw6ICdZZXN0ZXJkYXknLCB2YWx1ZTogJ3llc3RlcmRheSd9LFxuICAgICAge2xhYmVsOiAnTGFzdCA3IERheXMnLCB2YWx1ZTogJ3dlZWsnfSxcbiAgICAgIHtsYWJlbDogJ1RoaXMgTW9udGgnLCB2YWx1ZTogJ21vbnRoJ30sXG4gICAgXTtcblxuICAgIGl0KCdzaG91bGQgc3VwcHJlc3MgZGVmYXVsdCBicm93c2VyIGJlaGF2aW9yIHRvIHNlbGVjdCBpbnB1dCB0ZXh0IHdoZW4gdGFiIGZvY3VzZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7Y29udGFpbmVyfSA9IHJlbmRlcihcbiAgICAgICAgPEV6RmllbGQgdHlwZT1cInNlbGVjdFwiIGxhYmVsPXtpbnB1dExhYmVsfSBvcHRpb25zPXtvcHRpb25zfSB2YWx1ZT1cInVwY29taW5nXCIgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGlucHV0ID0gZ2V0QnlMYWJlbFRleHQoY29udGFpbmVyLCBpbnB1dExhYmVsKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXG4gICAgICAvLyBOT1RFOiBXZSBjYW4ndCBhY3R1YWxseSBzaW11bGF0ZSB0aGUgdGFiIGtleSBjYXVzaW5nIHRoZSBmb2N1cy9zZWxlY3QgYmVoYXZpb3JcbiAgICAgIC8vIGFzIGZpcmluZyBldmVudHMgZG9lcyBub3QgY2hhbmdlIGZvY3VzXG4gICAgICAvLyBzZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qc2RvbS9qc2RvbS9pc3N1ZXMvMjEwMiNpc3N1ZWNvbW1lbnQtMzU1MzQwOTY2XG4gICAgICBpbnB1dC5zZWxlY3QoKTtcbiAgICAgIGFjdCgoKSA9PiBSZWFjdFRlc3RVdGlscy5TaW11bGF0ZS5zZWxlY3QoaW5wdXQpKTtcblxuICAgICAgZXhwZWN0KGlucHV0LnNlbGVjdGlvbkVuZCAtIGlucHV0LnNlbGVjdGlvblN0YXJ0KS50b0VxdWFsKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBtb3ZlIHZpcnR1YWwgZm9jdXMgd2l0aCBhcnJvdyBrZXlzJywgKCkgPT4ge1xuICAgICAgY29uc3Qge2NvbnRhaW5lcn0gPSByZW5kZXIoXG4gICAgICAgIDxFekZpZWxkIHR5cGU9XCJzZWxlY3RcIiBsYWJlbD17aW5wdXRMYWJlbH0gb3B0aW9ucz17b3B0aW9uc30gdmFsdWU9XCJ1cGNvbWluZ1wiIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBpbnB1dCA9IGdldEJ5TGFiZWxUZXh0KGNvbnRhaW5lciwgaW5wdXRMYWJlbCkgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgICAgY29uc3Qga2V5RG93biA9IGtleSA9PiBmaXJlRXZlbnQua2V5RG93bihpbnB1dCwge2tleX0pO1xuXG4gICAgICBrZXlEb3duKCdBcnJvd0Rvd24nKTtcblxuICAgICAgY29uc3Qgb3B0aW9uMSA9IGdldEJ5VGV4dChjb250YWluZXIsICdBbGwgVXBjb21pbmcnKTtcbiAgICAgIGNvbnN0IG9wdGlvbjIgPSBnZXRCeVRleHQoY29udGFpbmVyLCAnVG9kYXknKTtcbiAgICAgIGNvbnN0IGxhc3RPcHRpb24gPSBnZXRCeVRleHQoY29udGFpbmVyLCAnVGhpcyBNb250aCcpO1xuXG4gICAgICBleHBlY3Qob3B0aW9uMSkudG9IYXZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICAgIGV4cGVjdChvcHRpb24yKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcblxuICAgICAga2V5RG93bignQXJyb3dEb3duJyk7XG5cbiAgICAgIGV4cGVjdChvcHRpb24xKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcbiAgICAgIGV4cGVjdChvcHRpb24yKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xuXG4gICAgICBrZXlEb3duKCdBcnJvd1VwJyk7XG5cbiAgICAgIGV4cGVjdChvcHRpb24xKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xuICAgICAgZXhwZWN0KG9wdGlvbjIpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuXG4gICAgICBrZXlEb3duKCdBcnJvd1VwJyk7XG5cbiAgICAgIGV4cGVjdChsYXN0T3B0aW9uKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xuICAgICAgZXhwZWN0KG9wdGlvbjEpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuXG4gICAgICBrZXlEb3duKCdBcnJvd0Rvd24nKTtcblxuICAgICAgZXhwZWN0KG9wdGlvbjEpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XG4gICAgICBleHBlY3QobGFzdE9wdGlvbikudG9IYXZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG1vdmUgdmlydHVhbCBmb2N1cyBieSBtYXRjaGluZyB0eXBlZCBjaGFyYWN0ZXJzIHRvIGFuIG9wdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IHtjb250YWluZXJ9ID0gcmVuZGVyKFxuICAgICAgICA8RXpGaWVsZCB0eXBlPVwic2VsZWN0XCIgbGFiZWw9e2lucHV0TGFiZWx9IG9wdGlvbnM9e29wdGlvbnN9IHZhbHVlPVwidG9kYXlcIiAvPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgaW5wdXQgPSBnZXRCeUxhYmVsVGV4dChjb250YWluZXIsIGlucHV0TGFiZWwpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAgIGNvbnN0IGtleURvd24gPSBrZXkgPT4gZmlyZUV2ZW50LmtleURvd24oaW5wdXQsIHtrZXl9KTtcblxuICAgICAgLy8gb3BlbiB0aGUgbWVudVxuICAgICAga2V5RG93bignQXJyb3dEb3duJyk7XG5cbiAgICAgIGNvbnN0IG9wdGlvbkFsbFVwY29taW5nID0gZ2V0QnlUZXh0KGNvbnRhaW5lciwgJ0FsbCBVcGNvbWluZycpO1xuICAgICAgY29uc3Qgb3B0aW9uQWxsVGltZSA9IGdldEJ5VGV4dChjb250YWluZXIsICdBbGwgVGltZScpO1xuXG4gICAgICBleHBlY3Qob3B0aW9uQWxsVXBjb21pbmcpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuICAgICAgZXhwZWN0KG9wdGlvbkFsbFRpbWUpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuXG4gICAgICBrZXlEb3duKCdhJyk7XG5cbiAgICAgIGV4cGVjdChvcHRpb25BbGxVcGNvbWluZykudG9IYXZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICAgIGV4cGVjdChvcHRpb25BbGxUaW1lKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcblxuICAgICAga2V5RG93bignbCcpO1xuICAgICAga2V5RG93bignbCcpO1xuICAgICAga2V5RG93bignICcpO1xuICAgICAga2V5RG93bigndCcpO1xuXG4gICAgICBleHBlY3Qob3B0aW9uQWxsVXBjb21pbmcpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuICAgICAgZXhwZWN0KG9wdGlvbkFsbFRpbWUpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XG5cbiAgICAgIC8vIGlnbm9yZSBzdWJzZXF1ZW50IFwibWlzc2VzXCJcbiAgICAgIGtleURvd24oJ3onKTtcblxuICAgICAgZXhwZWN0KG9wdGlvbkFsbFVwY29taW5nKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcbiAgICAgIGV4cGVjdChvcHRpb25BbGxUaW1lKS50b0hhdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xuXG4gICAgICAvLyBpZ25vcmUgbm9uLWFscGhhbnVtZXJpYyBjaGFyYWN0ZXJzXG4gICAgICBrZXlEb3duKCcqJyk7XG5cbiAgICAgIGV4cGVjdChvcHRpb25BbGxVcGNvbWluZykudG9IYXZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gICAgICBleHBlY3Qob3B0aW9uQWxsVGltZSkudG9IYXZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xvc2UgdGhlIGRyb3Bkb3duIHdoZW4gZXNjYXBlIGlzIHByZXNzZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7Y29udGFpbmVyLCBxdWVyeUJ5VGV4dH0gPSByZW5kZXIoXG4gICAgICAgIDxFekZpZWxkIHR5cGU9XCJzZWxlY3RcIiBsYWJlbD17aW5wdXRMYWJlbH0gb3B0aW9ucz17b3B0aW9uc30gdmFsdWU9XCJ1cGNvbWluZ1wiIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBpbnB1dCA9IGdldEJ5TGFiZWxUZXh0KGNvbnRhaW5lciwgaW5wdXRMYWJlbCkgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgICAgY29uc3Qga2V5RG93biA9IGtleSA9PiBmaXJlRXZlbnQua2V5RG93bihpbnB1dCwge2tleX0pO1xuXG4gICAgICBmaXJlRXZlbnQubW91c2VEb3duKGlucHV0KTtcblxuICAgICAgZXhwZWN0KHF1ZXJ5QnlUZXh0KCdUb2RheScpKS5ub3QudG9CZU51bGwoKTtcblxuICAgICAga2V5RG93bignRXNjYXBlJyk7XG5cbiAgICAgIGV4cGVjdChxdWVyeUJ5VGV4dCgnVG9kYXknKSkudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdHJpZ2dlciBvbkNoYW5nZSBmb3IgdGhlIGN1cnJlbnQgaXRlbSB3aGVuIGVudGVyIGlzIHByZXNzZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvbkNoYW5nZSA9IGplc3QuZm4oKTtcblxuICAgICAgY29uc3Qge2NvbnRhaW5lcn0gPSByZW5kZXIoXG4gICAgICAgIDxFekZpZWxkXG4gICAgICAgICAgdHlwZT1cInNlbGVjdFwiXG4gICAgICAgICAgbGFiZWw9e2lucHV0TGFiZWx9XG4gICAgICAgICAgb3B0aW9ucz17b3B0aW9uc31cbiAgICAgICAgICB2YWx1ZT1cInVwY29taW5nXCJcbiAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBpbnB1dCA9IGdldEJ5TGFiZWxUZXh0KGNvbnRhaW5lciwgaW5wdXRMYWJlbCkgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgICAgY29uc3Qga2V5RG93biA9IGtleSA9PiBmaXJlRXZlbnQua2V5RG93bihpbnB1dCwge2tleX0pO1xuXG4gICAgICAvLyBvcGVuIHRoZSBtZW51XG4gICAgICBrZXlEb3duKCdBcnJvd0Rvd24nKTtcblxuICAgICAgLy8gc2VsZWN0IHRoZSBzZWNvbmQgbmV4dCBvcHRpb24gKHZhbHVlIGlzIFwidG9kYXlcIilcbiAgICAgIGtleURvd24oJ0Fycm93RG93bicpO1xuXG4gICAgICBrZXlEb3duKCdFbnRlcicpO1xuXG4gICAgICBleHBlY3Qob25DaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgICAgY29uc3QgbGFzdENhbGwgPSBvbkNoYW5nZS5tb2NrLmNhbGxzW29uQ2hhbmdlLm1vY2suY2FsbHMubGVuZ3RoIC0gMV07XG5cbiAgICAgIGV4cGVjdChsYXN0Q2FsbFswXS50YXJnZXQudmFsdWUpLnRvRXF1YWwoJ3RvZGF5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRyaWdnZXIgb25DaGFuZ2UgZm9yIHRoZSBjdXJyZW50IGl0ZW0gd2hlbiBzcGFjZSBpcyBwcmVzc2VkJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG5cbiAgICAgIGNvbnN0IHtjb250YWluZXJ9ID0gcmVuZGVyKFxuICAgICAgICA8RXpGaWVsZFxuICAgICAgICAgIHR5cGU9XCJzZWxlY3RcIlxuICAgICAgICAgIGxhYmVsPXtpbnB1dExhYmVsfVxuICAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gICAgICAgICAgdmFsdWU9XCJ1cGNvbWluZ1wiXG4gICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgaW5wdXQgPSBnZXRCeUxhYmVsVGV4dChjb250YWluZXIsIGlucHV0TGFiZWwpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAgIGNvbnN0IGtleURvd24gPSBrZXkgPT4gZmlyZUV2ZW50LmtleURvd24oaW5wdXQsIHtrZXl9KTtcblxuICAgICAgLy8gb3BlbiB0aGUgbWVudVxuICAgICAga2V5RG93bignQXJyb3dEb3duJyk7XG5cbiAgICAgIC8vIHNlbGVjdCB0aGUgc2Vjb25kIG5leHQgb3B0aW9uICh2YWx1ZSBpcyBcInRvZGF5XCIpXG4gICAgICBrZXlEb3duKCdBcnJvd0Rvd24nKTtcblxuICAgICAga2V5RG93bignICcpO1xuXG4gICAgICBleHBlY3Qob25DaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgICAgY29uc3QgbGFzdENhbGwgPSBvbkNoYW5nZS5tb2NrLmNhbGxzW29uQ2hhbmdlLm1vY2suY2FsbHMubGVuZ3RoIC0gMV07XG5cbiAgICAgIGV4cGVjdChsYXN0Q2FsbFswXS50YXJnZXQudmFsdWUpLnRvRXF1YWwoJ3RvZGF5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRyaWdnZXIgb25DaGFuZ2UgZm9yIHRoZSBjdXJyZW50IGl0ZW0gd2hlbiBjbGlja2VkJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG5cbiAgICAgIGNvbnN0IHtjb250YWluZXJ9ID0gcmVuZGVyKFxuICAgICAgICA8RXpGaWVsZFxuICAgICAgICAgIHR5cGU9XCJzZWxlY3RcIlxuICAgICAgICAgIGxhYmVsPXtpbnB1dExhYmVsfVxuICAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gICAgICAgICAgdmFsdWU9XCJ1cGNvbWluZ1wiXG4gICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgaW5wdXQgPSBnZXRCeUxhYmVsVGV4dChjb250YWluZXIsIGlucHV0TGFiZWwpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAgIC8vIG9wZW4gdGhlIG1lbnVcbiAgICAgIGZpcmVFdmVudC5tb3VzZURvd24oaW5wdXQpO1xuXG4gICAgICBjb25zdCBvcHRpb24yID0gZ2V0QnlUZXh0KGNvbnRhaW5lciwgJ1RvZGF5Jyk7XG5cbiAgICAgIGZpcmVFdmVudC5tb3VzZU92ZXIob3B0aW9uMik7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhvcHRpb24yKTtcblxuICAgICAgZXhwZWN0KG9uQ2hhbmdlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cbiAgICAgIGNvbnN0IGxhc3RDYWxsID0gb25DaGFuZ2UubW9jay5jYWxsc1tvbkNoYW5nZS5tb2NrLmNhbGxzLmxlbmd0aCAtIDFdO1xuXG4gICAgICBleHBlY3QobGFzdENhbGxbMF0udGFyZ2V0LnZhbHVlKS50b0VxdWFsKCd0b2RheScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3ByZXZlbnRzIHRoZSBkZWZhdWx0IGV2ZW50IHByb3BhZ2F0aW9uIG9uIG1vdXNlRG93biBvbiBhbiBvcHRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBvbkNoYW5nZSA9IGplc3QuZm4oKTtcblxuICAgICAgY29uc3Qge2NvbnRhaW5lcn0gPSByZW5kZXIoXG4gICAgICAgIDxFekZpZWxkXG4gICAgICAgICAgdHlwZT1cInNlbGVjdFwiXG4gICAgICAgICAgbGFiZWw9e2lucHV0TGFiZWx9XG4gICAgICAgICAgb3B0aW9ucz17b3B0aW9uc31cbiAgICAgICAgICB2YWx1ZT1cInVwY29taW5nXCJcbiAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBpbnB1dCA9IGdldEJ5TGFiZWxUZXh0KGNvbnRhaW5lciwgaW5wdXRMYWJlbCkgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgICAgLy8gb3BlbiB0aGUgbWVudVxuICAgICAgZmlyZUV2ZW50Lm1vdXNlRG93bihpbnB1dCk7XG5cbiAgICAgIGNvbnN0IG9wdGlvbjIgPSBnZXRCeVRleHQoY29udGFpbmVyLCAnVG9kYXknKTtcbiAgICAgIGZpcmVFdmVudC5tb3VzZU92ZXIob3B0aW9uMik7XG4gICAgICBjb25zdCBtb2NrRXZlbnQgPSBuZXcgTW91c2VFdmVudCgnbW91c2Vkb3duJywge2J1YmJsZXM6IHRydWV9KTtcbiAgICAgIE9iamVjdC5hc3NpZ24obW9ja0V2ZW50LCB7cHJldmVudERlZmF1bHQ6IGplc3QuZm4oKX0pO1xuXG4gICAgICBmaXJlRXZlbnQob3B0aW9uMiwgbW9ja0V2ZW50KTtcblxuICAgICAgZXhwZWN0KG1vY2tFdmVudC5wcmV2ZW50RGVmYXVsdCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgdHJpZ2dlciBvbkNoYW5nZSBvbiB0aGUgaW5pdGlhbCByZW5kZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBvbkNoYW5nZSA9IGplc3QuZm4oKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8RXpGaWVsZFxuICAgICAgICAgIHR5cGU9XCJzZWxlY3RcIlxuICAgICAgICAgIGxhYmVsPXtpbnB1dExhYmVsfVxuICAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gICAgICAgICAgdmFsdWU9XCJ1cGNvbWluZ1wiXG4gICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KG9uQ2hhbmdlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0cmlnZ2VyIG9uQ2hhbmdlIGFmdGVyIG1hdGNoaW5nIHR5cGVkIGNoYXJhY3RlcnMgdG8gYW4gb3B0aW9uLCBldmVuIHdpdGggdGhlIGxpc3QgaXMgY2xvc2VkJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG5cbiAgICAgIGNvbnN0IHtjb250YWluZXJ9ID0gcmVuZGVyKFxuICAgICAgICA8RXpGaWVsZFxuICAgICAgICAgIHR5cGU9XCJzZWxlY3RcIlxuICAgICAgICAgIGxhYmVsPXtpbnB1dExhYmVsfVxuICAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gICAgICAgICAgdmFsdWU9XCJ0b2RheVwiXG4gICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgaW5wdXQgPSBnZXRCeUxhYmVsVGV4dChjb250YWluZXIsIGlucHV0TGFiZWwpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAgIGNvbnN0IGtleURvd24gPSBrZXkgPT4gZmlyZUV2ZW50LmtleURvd24oaW5wdXQsIHtrZXl9KTtcblxuICAgICAga2V5RG93bigneScpO1xuXG4gICAgICBleHBlY3Qob25DaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgICAgY29uc3QgbGFzdENhbGwgPSBvbkNoYW5nZS5tb2NrLmNhbGxzW29uQ2hhbmdlLm1vY2suY2FsbHMubGVuZ3RoIC0gMV07XG5cbiAgICAgIGV4cGVjdChsYXN0Q2FsbFswXS50YXJnZXQudmFsdWUpLnRvRXF1YWwoJ3llc3RlcmRheScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgdHJpZ2dlciBvbkNoYW5nZSB3aGVuIHJlLXJlbmRlcmVkIHdpdGggbmV3IHByb3BzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG5cbiAgICAgIGNvbnN0IHtyZXJlbmRlcn0gPSByZW5kZXIoXG4gICAgICAgIDxFekZpZWxkXG4gICAgICAgICAgdHlwZT1cInNlbGVjdFwiXG4gICAgICAgICAgbGFiZWw9e2lucHV0TGFiZWx9XG4gICAgICAgICAgb3B0aW9ucz17b3B0aW9uc31cbiAgICAgICAgICB2YWx1ZT1cInVwY29taW5nXCJcbiAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgICAgLy8gY2hhbmdlIHRvIGEgbmV3IHZhbHVlXG4gICAgICByZXJlbmRlcihcbiAgICAgICAgPEV6RmllbGRcbiAgICAgICAgICB0eXBlPVwic2VsZWN0XCJcbiAgICAgICAgICBsYWJlbD17aW5wdXRMYWJlbH1cbiAgICAgICAgICBvcHRpb25zPXtvcHRpb25zfVxuICAgICAgICAgIHZhbHVlPVwidG9tb3Jyb3dcIlxuICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgICAvLyBcInJlc2V0XCIgYmFjayB0byBvcmlnaW5hbCB2YWx1ZVxuICAgICAgcmVyZW5kZXIoXG4gICAgICAgIDxFekZpZWxkXG4gICAgICAgICAgdHlwZT1cInNlbGVjdFwiXG4gICAgICAgICAgbGFiZWw9e2lucHV0TGFiZWx9XG4gICAgICAgICAgb3B0aW9ucz17b3B0aW9uc31cbiAgICAgICAgICB2YWx1ZT1cInVwY29taW5nXCJcbiAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qob25DaGFuZ2UpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1cHBvcnQgY2hvaWNlcyB3aXRoIG51bWVyaWMgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG5cbiAgICAgIGNvbnN0IG9wdGlvbnNXaXRoTnVtZXJpY1ZhbHVlcyA9IFtcbiAgICAgICAge2xhYmVsOiAnU2hvcnQnLCB2YWx1ZTogNX0sXG4gICAgICAgIHtsYWJlbDogJ01lZGl1bScsIHZhbHVlOiAxMH0sXG4gICAgICAgIHtsYWJlbDogJ0xvbmcnLCB2YWx1ZTogMTV9LFxuICAgICAgXTtcblxuICAgICAgY29uc3Qge2NvbnRhaW5lcn0gPSByZW5kZXIoXG4gICAgICAgIDxFekZpZWxkXG4gICAgICAgICAgdHlwZT1cInNlbGVjdFwiXG4gICAgICAgICAgbGFiZWw9e2lucHV0TGFiZWx9XG4gICAgICAgICAgb3B0aW9ucz17b3B0aW9uc1dpdGhOdW1lcmljVmFsdWVzfVxuICAgICAgICAgIHZhbHVlPXs1fVxuICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGlucHV0ID0gZ2V0QnlMYWJlbFRleHQoY29udGFpbmVyLCBpbnB1dExhYmVsKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXG4gICAgICBjb25zdCBrZXlEb3duID0ga2V5ID0+IGZpcmVFdmVudC5rZXlEb3duKGlucHV0LCB7a2V5fSk7XG5cbiAgICAgIC8vIG9wZW4gdGhlIG1lbnVcbiAgICAgIGtleURvd24oJ0Fycm93RG93bicpO1xuXG4gICAgICAvLyBzZWxlY3QgdGhlIHNlY29uZCBuZXh0IG9wdGlvbiAodmFsdWUgaXMgXCJNZWRpdW1cIilcbiAgICAgIGtleURvd24oJ0Fycm93RG93bicpO1xuXG4gICAgICBrZXlEb3duKCdFbnRlcicpO1xuXG4gICAgICBleHBlY3Qob25DaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgICAgY29uc3QgbGFzdENhbGwgPSBvbkNoYW5nZS5tb2NrLmNhbGxzW29uQ2hhbmdlLm1vY2suY2FsbHMubGVuZ3RoIC0gMV07XG5cbiAgICAgIGV4cGVjdChsYXN0Q2FsbFswXS50YXJnZXQudmFsdWUpLnRvRXF1YWwoMTApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19