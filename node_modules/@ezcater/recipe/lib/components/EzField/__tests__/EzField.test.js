"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _react = _interopRequireDefault(require("react"));

var _sosia = require("sosia");

var _jestAxe = require("jest-axe");

var _react2 = require("@testing-library/react");

var _EzFieldTest = _interopRequireDefault(require("./EzField.test.md"));

var _EzField = _interopRequireDefault(require("../EzField.md"));

var _EzField2 = _interopRequireDefault(require("../EzField"));

var _jestGlobals = require("../../../jest-globals");

var _index = require("../../index");

var _Open = _interopRequireDefault(require("../Open"));

var _Media = _interopRequireDefault(require("../Media"));

var scope = {
  EzButton: _index.EzButton,
  EzField: _EzField2["default"],
  EzLayout: _index.EzLayout,
  EzFormLayout: _index.EzFormLayout,
  Open: _Open["default"],
  Media: _Media["default"]
};
describe('EzField', function () {
  (0, _sosia.visualSnapshots)({
    markdown: _EzField["default"],
    scope: scope
  });
  (0, _sosia.visualSnapshots)({
    markdown: _EzFieldTest["default"],
    scope: scope
  });
  it('should render with disabled input', function () {
    var _render = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField2["default"], {
      label: "Disabled input",
      disabled: true
    })),
        container = _render.container;

    expect((0, _react2.getByLabelText)(container, 'Disabled input')).toHaveAttribute('disabled');
  });
  it('should update character count as the user enters text', function () {
    var _render2 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField2["default"], {
      label: "Character Name",
      maxLength: 120
    })),
        container = _render2.container;

    expect(container).toHaveTextContent('0/120');
    var input = (0, _react2.getByLabelText)(container, 'Character Name');

    _react2.fireEvent.change(input, {
      target: {
        value: 'Oscar the grouch'
      }
    });

    expect(container).toHaveTextContent('16/120');
  });
  it('should call provided onChange handler if the input changes', function () {
    var spy = jest.fn();

    var _render3 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField2["default"], {
      label: "Basic Text",
      onChange: spy
    })),
        container = _render3.container;

    var input = (0, _react2.getByLabelText)(container, 'Basic Text');

    _react2.fireEvent.change(input, {
      target: {
        value: 'new value'
      }
    });

    expect(spy).toHaveBeenCalled();
  });
  it('should NOT update character count if the provided onChange handler prevents default', function () {
    var _render4 = (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField2["default"], {
      label: "Character Name",
      maxLength: 120,
      onChange: function onChange(e) {
        return e.preventDefault();
      }
    })),
        container = _render4.container;

    expect(container).toHaveTextContent('0/120');
    var input = (0, _react2.getByLabelText)(container, 'Character Name');

    _react2.fireEvent.change(input, {
      target: {
        value: 'Oscar the grouch'
      }
    });

    expect(container).toHaveTextContent('0/120');
  });
  it('should not lose focus when typing causes the validation state to toggle', function () {
    var Example = function Example() {
      var _React$useState = _react["default"].useState('value'),
          _React$useState2 = (0, _slicedToArray2["default"])(_React$useState, 2),
          value = _React$useState2[0],
          setValue = _React$useState2[1];

      return _react["default"].createElement(_EzField2["default"], {
        type: "text",
        label: "Field label",
        value: value,
        onChange: function onChange(e) {
          return setValue(e.target.value);
        },
        touched: true,
        error: value.length < 6 && 'Oops!',
        helperText: "click the checkbox to make input invalid"
      });
    };

    var _render5 = (0, _jestGlobals.fullRender)(_react["default"].createElement(Example, null)),
        container = _render5.container;

    var input = (0, _react2.getByLabelText)(container, 'Field label');
    (0, _react2.act)(function () {
      return input.focus();
    });
    expect(input).toHaveFocus();

    _react2.fireEvent.change(input, {
      target: {
        value: 'trigger the field error'
      }
    });

    expect(input).toHaveFocus();
  });
  it('should apply ref to the underlying input element', function () {
    var spy = jest.fn(function (el) {
      if (!el) return;
      expect(el.type).toEqual('text');
    });
    (0, _jestGlobals.fullRender)(_react["default"].createElement(_EzField2["default"], {
      label: "Character Name",
      ref: spy
    }));
    expect.assertions(1);
  });
  it('should meet accessibility guidelines',
  /*#__PURE__*/
  (0, _asyncToGenerator2["default"])(
  /*#__PURE__*/
  _regenerator["default"].mark(function _callee() {
    var wrapper, actual;
    return _regenerator["default"].wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            wrapper = (0, _jestGlobals.renderToHtml)(_react["default"].createElement(_EzField2["default"], {
              label: "Basic text"
            }));
            _context.next = 3;
            return (0, _jestAxe.axe)(wrapper);

          case 3:
            actual = _context.sent;
            expect(actual).toHaveNoViolations();

          case 5:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  })));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL0V6RmllbGQvX190ZXN0c19fL0V6RmllbGQudGVzdC50c3giXSwibmFtZXMiOlsic2NvcGUiLCJFekJ1dHRvbiIsIkV6RmllbGQiLCJFekxheW91dCIsIkV6Rm9ybUxheW91dCIsIk9wZW4iLCJNZWRpYSIsImRlc2NyaWJlIiwibWFya2Rvd24iLCJyZWdyZXNzaW9uVGVzdHMiLCJpdCIsImNvbnRhaW5lciIsImV4cGVjdCIsInRvSGF2ZUF0dHJpYnV0ZSIsInRvSGF2ZVRleHRDb250ZW50IiwiaW5wdXQiLCJmaXJlRXZlbnQiLCJjaGFuZ2UiLCJ0YXJnZXQiLCJ2YWx1ZSIsInNweSIsImplc3QiLCJmbiIsInRvSGF2ZUJlZW5DYWxsZWQiLCJlIiwicHJldmVudERlZmF1bHQiLCJFeGFtcGxlIiwiUmVhY3QiLCJ1c2VTdGF0ZSIsInNldFZhbHVlIiwibGVuZ3RoIiwiZm9jdXMiLCJ0b0hhdmVGb2N1cyIsImVsIiwidHlwZSIsInRvRXF1YWwiLCJhc3NlcnRpb25zIiwid3JhcHBlciIsImFjdHVhbCIsInRvSGF2ZU5vVmlvbGF0aW9ucyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBLElBQU1BLEtBQUssR0FBRztBQUFDQyxFQUFBQSxRQUFRLEVBQVJBLGVBQUQ7QUFBV0MsRUFBQUEsT0FBTyxFQUFQQSxvQkFBWDtBQUFvQkMsRUFBQUEsUUFBUSxFQUFSQSxlQUFwQjtBQUE4QkMsRUFBQUEsWUFBWSxFQUFaQSxtQkFBOUI7QUFBNENDLEVBQUFBLElBQUksRUFBSkEsZ0JBQTVDO0FBQWtEQyxFQUFBQSxLQUFLLEVBQUxBO0FBQWxELENBQWQ7QUFFQUMsUUFBUSxDQUFDLFNBQUQsRUFBWSxZQUFNO0FBQ3hCLDhCQUFnQjtBQUFDQyxJQUFBQSxRQUFRLEVBQVJBLG1CQUFEO0FBQVdSLElBQUFB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QUFRLFVBQUFXLEVBQUUsRUFBSTtBQUN4QixVQUFJLENBQUNBLEVBQUwsRUFBUztBQUNUckIsTUFBQUEsTUFBTSxDQUFDcUIsRUFBRSxDQUFDQyxJQUFKLENBQU4sQ0FBZ0JDLE9BQWhCLENBQXdCLE1BQXhCO0FBQ0QsS0FIVyxDQUFaO0FBS0EsaUNBQU8sZ0NBQUMsb0JBQUQ7QUFBUyxNQUFBLEtBQUssRUFBQyxnQkFBZjtBQUFnQyxNQUFBLEdBQUcsRUFBRWY7QUFBckMsTUFBUDtBQUVBUixJQUFBQSxNQUFNLENBQUN3QixVQUFQLENBQWtCLENBQWxCO0FBQ0QsR0FUQyxDQUFGO0FBV0ExQixFQUFBQSxFQUFFLENBQUMsc0NBQUQ7QUFBQTtBQUFBO0FBQUE7QUFBQSwrQkFBeUM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ25DMkIsWUFBQUEsT0FEbUMsR0FDekIsK0JBQWEsZ0NBQUMsb0JBQUQ7QUFBUyxjQUFBLEtBQUssRUFBQztBQUFmLGNBQWIsQ0FEeUI7QUFBQTtBQUFBLG1CQUVwQixrQkFBSUEsT0FBSixDQUZvQjs7QUFBQTtBQUVuQ0MsWUFBQUEsTUFGbUM7QUFHekMxQixZQUFBQSxNQUFNLENBQUMwQixNQUFELENBQU4sQ0FBZUMsa0JBQWY7O0FBSHlDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEdBQXpDLEdBQUY7QUFLRCxDQTVGTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7dmlzdWFsU25hcHNob3RzfSBmcm9tICdzb3NpYSc7XG5pbXBvcnQge2F4ZX0gZnJvbSAnamVzdC1heGUnO1xuaW1wb3J0IHtnZXRCeUxhYmVsVGV4dCwgZmlyZUV2ZW50LCBhY3R9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHJlZ3Jlc3Npb25UZXN0cyBmcm9tICcuL0V6RmllbGQudGVzdC5tZCc7XG5pbXBvcnQgbWFya2Rvd24gZnJvbSAnLi4vRXpGaWVsZC5tZCc7XG5pbXBvcnQgRXpGaWVsZCBmcm9tICcuLi9FekZpZWxkJztcbmltcG9ydCB7ZnVsbFJlbmRlciBhcyByZW5kZXIsIHJlbmRlclRvSHRtbH0gZnJvbSAnLi4vLi4vLi4vamVzdC1nbG9iYWxzJztcbmltcG9ydCB7RXpCdXR0b24sIEV6Rm9ybUxheW91dCwgRXpMYXlvdXR9IGZyb20gJy4uLy4uL2luZGV4JztcbmltcG9ydCBPcGVuIGZyb20gJy4uL09wZW4nO1xuaW1wb3J0IE1lZGlhIGZyb20gJy4uL01lZGlhJztcblxuY29uc3Qgc2NvcGUgPSB7RXpCdXR0b24sIEV6RmllbGQsIEV6TGF5b3V0LCBFekZvcm1MYXlvdXQsIE9wZW4sIE1lZGlhfTtcblxuZGVzY3JpYmUoJ0V6RmllbGQnLCAoKSA9PiB7XG4gIHZpc3VhbFNuYXBzaG90cyh7bWFya2Rvd24sIHNjb3BlfSk7XG4gIHZpc3VhbFNuYXBzaG90cyh7bWFya2Rvd246IHJlZ3Jlc3Npb25UZXN0cywgc2NvcGV9KTtcblxuICBpdCgnc2hvdWxkIHJlbmRlciB3aXRoIGRpc2FibGVkIGlucHV0JywgKCkgPT4ge1xuICAgIGNvbnN0IHtjb250YWluZXJ9ID0gcmVuZGVyKDxFekZpZWxkIGxhYmVsPVwiRGlzYWJsZWQgaW5wdXRcIiBkaXNhYmxlZCAvPik7XG5cbiAgICBleHBlY3QoZ2V0QnlMYWJlbFRleHQoY29udGFpbmVyLCAnRGlzYWJsZWQgaW5wdXQnKSkudG9IYXZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHVwZGF0ZSBjaGFyYWN0ZXIgY291bnQgYXMgdGhlIHVzZXIgZW50ZXJzIHRleHQnLCAoKSA9PiB7XG4gICAgY29uc3Qge2NvbnRhaW5lcn0gPSByZW5kZXIoPEV6RmllbGQgbGFiZWw9XCJDaGFyYWN0ZXIgTmFtZVwiIG1heExlbmd0aD17MTIwfSAvPik7XG5cbiAgICBleHBlY3QoY29udGFpbmVyKS50b0hhdmVUZXh0Q29udGVudCgnMC8xMjAnKTtcblxuICAgIGNvbnN0IGlucHV0ID0gZ2V0QnlMYWJlbFRleHQoY29udGFpbmVyLCAnQ2hhcmFjdGVyIE5hbWUnKTtcblxuICAgIGZpcmVFdmVudC5jaGFuZ2UoaW5wdXQsIHt0YXJnZXQ6IHt2YWx1ZTogJ09zY2FyIHRoZSBncm91Y2gnfX0pO1xuXG4gICAgZXhwZWN0KGNvbnRhaW5lcikudG9IYXZlVGV4dENvbnRlbnQoJzE2LzEyMCcpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGNhbGwgcHJvdmlkZWQgb25DaGFuZ2UgaGFuZGxlciBpZiB0aGUgaW5wdXQgY2hhbmdlcycsICgpID0+IHtcbiAgICBjb25zdCBzcHkgPSBqZXN0LmZuKCk7XG4gICAgY29uc3Qge2NvbnRhaW5lcn0gPSByZW5kZXIoPEV6RmllbGQgbGFiZWw9XCJCYXNpYyBUZXh0XCIgb25DaGFuZ2U9e3NweX0gLz4pO1xuXG4gICAgY29uc3QgaW5wdXQgPSBnZXRCeUxhYmVsVGV4dChjb250YWluZXIsICdCYXNpYyBUZXh0Jyk7XG5cbiAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0LCB7dGFyZ2V0OiB7dmFsdWU6ICduZXcgdmFsdWUnfX0pO1xuXG4gICAgZXhwZWN0KHNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIE5PVCB1cGRhdGUgY2hhcmFjdGVyIGNvdW50IGlmIHRoZSBwcm92aWRlZCBvbkNoYW5nZSBoYW5kbGVyIHByZXZlbnRzIGRlZmF1bHQnLCAoKSA9PiB7XG4gICAgY29uc3Qge2NvbnRhaW5lcn0gPSByZW5kZXIoXG4gICAgICA8RXpGaWVsZCBsYWJlbD1cIkNoYXJhY3RlciBOYW1lXCIgbWF4TGVuZ3RoPXsxMjB9IG9uQ2hhbmdlPXtlID0+IGUucHJldmVudERlZmF1bHQoKX0gLz5cbiAgICApO1xuXG4gICAgZXhwZWN0KGNvbnRhaW5lcikudG9IYXZlVGV4dENvbnRlbnQoJzAvMTIwJyk7XG5cbiAgICBjb25zdCBpbnB1dCA9IGdldEJ5TGFiZWxUZXh0KGNvbnRhaW5lciwgJ0NoYXJhY3RlciBOYW1lJyk7XG5cbiAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0LCB7dGFyZ2V0OiB7dmFsdWU6ICdPc2NhciB0aGUgZ3JvdWNoJ319KTtcblxuICAgIGV4cGVjdChjb250YWluZXIpLnRvSGF2ZVRleHRDb250ZW50KCcwLzEyMCcpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG5vdCBsb3NlIGZvY3VzIHdoZW4gdHlwaW5nIGNhdXNlcyB0aGUgdmFsaWRhdGlvbiBzdGF0ZSB0byB0b2dnbGUnLCAoKSA9PiB7XG4gICAgY29uc3QgRXhhbXBsZSA9ICgpID0+IHtcbiAgICAgIGNvbnN0IFt2YWx1ZSwgc2V0VmFsdWVdID0gUmVhY3QudXNlU3RhdGUoJ3ZhbHVlJyk7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8RXpGaWVsZFxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICBsYWJlbD1cIkZpZWxkIGxhYmVsXCJcbiAgICAgICAgICB2YWx1ZT17dmFsdWV9XG4gICAgICAgICAgb25DaGFuZ2U9e2UgPT4gc2V0VmFsdWUoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgIHRvdWNoZWRcbiAgICAgICAgICBlcnJvcj17dmFsdWUubGVuZ3RoIDwgNiAmJiAnT29wcyEnfVxuICAgICAgICAgIGhlbHBlclRleHQ9XCJjbGljayB0aGUgY2hlY2tib3ggdG8gbWFrZSBpbnB1dCBpbnZhbGlkXCJcbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgfTtcblxuICAgIGNvbnN0IHtjb250YWluZXJ9ID0gcmVuZGVyKDxFeGFtcGxlIC8+KTtcblxuICAgIGNvbnN0IGlucHV0ID0gZ2V0QnlMYWJlbFRleHQoY29udGFpbmVyLCAnRmllbGQgbGFiZWwnKTtcblxuICAgIGFjdCgoKSA9PiBpbnB1dC5mb2N1cygpKTtcblxuICAgIGV4cGVjdChpbnB1dCkudG9IYXZlRm9jdXMoKTtcblxuICAgIGZpcmVFdmVudC5jaGFuZ2UoaW5wdXQsIHt0YXJnZXQ6IHt2YWx1ZTogJ3RyaWdnZXIgdGhlIGZpZWxkIGVycm9yJ319KTtcblxuICAgIGV4cGVjdChpbnB1dCkudG9IYXZlRm9jdXMoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBhcHBseSByZWYgdG8gdGhlIHVuZGVybHlpbmcgaW5wdXQgZWxlbWVudCcsICgpID0+IHtcbiAgICBjb25zdCBzcHkgPSBqZXN0LmZuKGVsID0+IHtcbiAgICAgIGlmICghZWwpIHJldHVybjtcbiAgICAgIGV4cGVjdChlbC50eXBlKS50b0VxdWFsKCd0ZXh0Jyk7XG4gICAgfSk7XG5cbiAgICByZW5kZXIoPEV6RmllbGQgbGFiZWw9XCJDaGFyYWN0ZXIgTmFtZVwiIHJlZj17c3B5fSAvPik7XG5cbiAgICBleHBlY3QuYXNzZXJ0aW9ucygxKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBtZWV0IGFjY2Vzc2liaWxpdHkgZ3VpZGVsaW5lcycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB3cmFwcGVyID0gcmVuZGVyVG9IdG1sKDxFekZpZWxkIGxhYmVsPVwiQmFzaWMgdGV4dFwiIC8+KTtcbiAgICBjb25zdCBhY3R1YWwgPSBhd2FpdCBheGUod3JhcHBlcik7XG4gICAgZXhwZWN0KGFjdHVhbCkudG9IYXZlTm9WaW9sYXRpb25zKCk7XG4gIH0pO1xufSk7XG4iXX0=